{"version":3,"file":"index.min.js","mappings":"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","sources":["webpack:///./use-did-update.ts","webpack:///./use-form.ts","webpack:///./utils.ts","webpack:///external \"react\"","webpack:///webpack/bootstrap","webpack:///./index.ts"],"sourcesContent":["import { DependencyList, EffectCallback, useEffect, useRef } from \"react\";\n\nexport const useDidUpdate = (\n  effect: EffectCallback,\n  dependencies: DependencyList\n) => {\n  const hasMounted = useRef(true);\n\n  useEffect(() => {\n    if (hasMounted.current) {\n      hasMounted.current = false;\n      return;\n    }\n\n    return effect();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n};\n","import { useCallback, useMemo, useState } from \"react\";\nimport { InitialForm } from \"./types\";\nimport { useDidUpdate } from \"./use-did-update\";\nimport { initialFn, reduceConfigTransform } from \"./utils\";\n\ntype Values<T extends InitialForm<any>> = { [k in keyof T]: any } &\n  Record<string, any>;\n\ntype HandlersConfig = {\n  value: any;\n  error:\n    | {\n        errorMessage: string;\n      }\n    | undefined;\n  touched: boolean;\n  onChange: (value: any) => void;\n};\n\ntype Handlers<T extends InitialForm<any>> = {\n  [k in keyof T]: HandlersConfig;\n} &\n  Record<string, HandlersConfig>;\n\nexport const useForm = <T extends InitialForm<any>>(initialForm: T) => {\n  const [form, setForm] = useState(() => initialFn<keyof T>(initialForm));\n\n  useDidUpdate(() => {\n    setForm(() => initialFn<keyof T>(initialForm));\n  }, [initialForm]);\n\n  const values = useMemo<Values<T>>(\n    () => reduceConfigTransform(form, ({ value }) => value),\n    [form]\n  );\n\n  const addFields = useCallback(\n    (obj: {\n      [field: string]: {\n        value: any;\n        touched?: boolean;\n        validation?: (value: any) =>\n          | undefined\n          | {\n              errorMessage: string;\n            };\n      };\n    }) => {\n      setForm((prev) => ({\n        ...prev,\n        ...reduceConfigTransform(obj, (config) => ({\n          ...config,\n          error: config?.validation && config.validation(config.value),\n          touched: config?.touched ?? false,\n          value: config.value,\n        })),\n      }));\n    },\n    []\n  );\n\n  const removeField = useCallback((fieldName: string) => {\n    setForm((prev) => ({\n      ...(Object.fromEntries(\n        Object.entries(prev).filter(([field]) => field !== fieldName)\n      ) as typeof prev),\n    }));\n  }, []);\n\n  const setValue = useCallback(\n    (key: keyof T, value: any, touched?: boolean) => {\n      setForm((prev) => {\n        const config = prev[key];\n\n        if (!config) return prev;\n\n        return {\n          ...prev,\n          [key]: {\n            ...config,\n            error: config.validation && config.validation(value),\n            touched: touched ?? config.touched,\n            value,\n          },\n        };\n      });\n    },\n    []\n  );\n\n  const setValues = useCallback(\n    (\n      obj: {\n        [key in keyof T]?: {\n          value: any;\n          touched?: boolean;\n        };\n      }\n    ) => {\n      setForm((prev) =>\n        reduceConfigTransform(prev, (config, field) => {\n          if (!(field in obj)) return config;\n\n          const _value = obj[field]?.value;\n\n          return {\n            ...config,\n            error: config.validation && config.validation(_value),\n            touched: obj[field]?.touched ?? config.touched,\n            value: _value ?? config.value,\n          };\n        })\n      );\n    },\n    []\n  );\n\n  const handlers = useMemo<Handlers<T>>(\n    () =>\n      reduceConfigTransform(form, (config, key) => ({\n        value: config.value,\n        error: config.error,\n        touched: config.touched,\n        onChange: (value: any) => setValue(key, value, true),\n      })),\n    [setValue, form]\n  );\n\n  const isInvalidForm = useMemo(\n    () =>\n      Object.values(form).reduce(\n        (acc, { error }) => acc || Boolean(error),\n        false\n      ),\n    [form]\n  );\n\n  const resetHandler = useCallback(\n    () => setForm(() => initialFn<keyof T>(initialForm)),\n    [initialForm]\n  );\n\n  return {\n    values,\n    handlers,\n    resetHandler,\n    setValues,\n    setValue,\n    addFields,\n    removeField,\n    isInvalidForm,\n  };\n};\n","import { InitialForm, ReduceConfigTransformType } from \"./types\";\n\nexport const isPrimitive = (value: unknown): value is true =>\n  value !== Object(value);\n\nexport type CompressType<T extends Record<any, any>, F extends keyof T[any]> = {\n  [key in keyof T]: T[key][F];\n};\n\nexport const reduceConfigTransform: ReduceConfigTransformType = (\n  obj,\n  callback\n) =>\n  Object.entries(obj).reduce(\n    (acc, [key, config]) => ({\n      ...acc,\n      [key]: callback(config, key as any, obj),\n    }),\n    {} as any\n  );\n\nexport const initialFn = <T extends keyof any>(initialForm: InitialForm<T>) =>\n  reduceConfigTransform(initialForm, (config) => ({\n    ...config,\n    touched: false,\n    error: config.validation && config.validation(config.value),\n  }));\n","module.exports = __WEBPACK_EXTERNAL_MODULE__297__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","export { useForm } from \"./use-form\";\nimport { InitialForm } from \"./types\";\nexport type InitialFormType<T extends keyof any> = InitialForm<T>;\n"],"names":["useDidUpdate","effect","dependencies","hasMounted","useRef","useEffect","current","useForm","initialForm","useState","initialFn","form","setForm","values","useMemo","reduceConfigTransform","addFields","useCallback","obj","prev","config","error","validation","value","touched","removeField","fieldName","Object","fromEntries","entries","filter","setValue","key","setValues","field","_value","handlers","onChange","isInvalidForm","reduce","acc","Boolean","resetHandler","isPrimitive","callback","module","exports","__WEBPACK_EXTERNAL_MODULE__297__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}