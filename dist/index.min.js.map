{"version":3,"sources":["webpack:///./index.ts","webpack:///./use-component-did-update.ts","webpack:///./use-form.ts","webpack:///./utils.ts","webpack:///external \"react\"","webpack:///webpack/bootstrap","webpack:///webpack/startup"],"names":["useForm","useComponentDidUpdate","effect","dependencies","hasMounted","useRef","useEffect","current","initialForm","useState","initialFn","form","setForm","values","useMemo","reduceConfigTransform","setValue","useCallback","key","value","touched","prev","config","field","_value","_touched","Array","isArray","isPrimitive","error","validation","invalid","Boolean","onChange","ev","target","handlers","isInvalidForm","Object","reduce","acc","resetHandler","obj","callback","entries","module","exports","__WEBPACK_EXTERNAL_MODULE__297__","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","call"],"mappings":"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","file":"index.min.js","sourcesContent":["export { useForm } from \"./use-form\";\nimport { InitialForm } from \"./types\";\nexport type InitialFormType<T extends keyof any> = InitialForm<T>;\n","import { DependencyList, EffectCallback, useEffect, useRef } from \"react\";\n\nexport const useComponentDidUpdate = (\n  effect: EffectCallback,\n  dependencies?: DependencyList\n) => {\n  const hasMounted = useRef(true);\n\n  useEffect(() => {\n    if (hasMounted.current) {\n      hasMounted.current = false;\n      return;\n    }\n\n    return effect();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n};\n","import { useCallback, useMemo, useState } from \"react\";\nimport { InitialForm, ISetValue } from \"./types\";\nimport { useComponentDidUpdate } from \"./use-component-did-update\";\nimport { initialFn, isPrimitive, reduceConfigTransform } from \"./utils\";\n\nexport const useForm = <T extends InitialForm<any>>(initialForm: T) => {\n  const [form, setForm] = useState(() => initialFn(initialForm));\n\n  useComponentDidUpdate(() => {\n    setForm(() => initialFn(initialForm));\n  }, [initialForm]);\n\n  const values = useMemo(\n    () => reduceConfigTransform(form, ({ value }) => value),\n    [form]\n  );\n\n  const setValue = useCallback((key, value, touched) => {\n    if (typeof key === \"object\") {\n      setForm((prev) =>\n        reduceConfigTransform(prev, (config, field) => {\n          if (!(field in key)) {\n            return config;\n          }\n\n          let _value;\n          let _touched;\n\n          if (Array.isArray(key[field]) || isPrimitive(key[field])) {\n            _value = key[field];\n          } else {\n            _value = key[field].value;\n            _touched = key[field].touched;\n          }\n\n          const error = config.validation && config.validation(_value);\n\n          return {\n            ...config,\n            error,\n            invalid: Boolean(error),\n            touched: _touched ?? config.touched,\n            value: _value ?? config.value,\n          };\n        })\n      );\n    } else {\n      setForm((prev) => {\n        const config = prev[key];\n        const error = config.validation && config.validation(value);\n        return {\n          ...prev,\n          [key]: {\n            ...config,\n            error: error,\n            invalid: Boolean(error),\n            touched: touched ?? config.touched,\n            value,\n          },\n        };\n      });\n    }\n  }, []);\n\n  const onChange = useCallback(\n    (key: any) => <T extends HTMLTextAreaElement | HTMLInputElement>(\n      ev: React.ChangeEvent<T> | any\n    ) => {\n      setValue(key, ev.target ? ev.target.value : ev, true);\n    },\n    [setValue]\n  );\n\n  const handlers = useMemo(\n    () =>\n      reduceConfigTransform(form, (config, key) => ({\n        ...config,\n        onChange: onChange(key),\n      })),\n    [onChange, form]\n  );\n\n  const isInvalidForm = useMemo(\n    () =>\n      Object.values(form).reduce((acc, { invalid }) => acc || invalid, false),\n    [form]\n  );\n\n  const resetHandler = useCallback(\n    () => setForm(() => initialFn(initialForm)),\n    [initialForm]\n  );\n\n  return {\n    values,\n    handlers,\n    resetHandler,\n    setValue: setValue as ISetValue<T>,\n    isInvalidForm,\n  };\n};\n","import { InitialForm, ReduceConfigTransformType } from \"./types\";\n\nexport const isPrimitive = <T>(value: T) => value !== Object(value);\n\nexport const reduceConfigTransform: ReduceConfigTransformType = (\n  obj,\n  callback\n) =>\n  Object.entries(obj).reduce(\n    (acc, [key, config]) => ({\n      ...acc,\n      [key]: callback(config, key as any, obj),\n    }),\n    {} as any\n  );\n\nexport const initialFn = <T extends InitialForm<any>>(initialForm: T) =>\n  reduceConfigTransform(initialForm, (config) => {\n    const error = config.validation && config.validation(config.value);\n    return {\n      ...config,\n      touched: false,\n      invalid: Boolean(error),\n      error,\n    };\n  });\n","module.exports = __WEBPACK_EXTERNAL_MODULE__297__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(447);\n"],"sourceRoot":""}