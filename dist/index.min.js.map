{"version":3,"sources":["webpack:///./index.ts","webpack:///./utils.ts","webpack:///external \"react\"","webpack:///webpack/bootstrap","webpack:///webpack/startup"],"names":["initialFn","initialForm","reduceConfigTransform","config","error","validation","value","touched","invalid","Boolean","useForm","useState","form","setForm","values","useMemo","setValue","useCallback","key","prev","field","_value","_touched","isPrimitive","onChange","ev","target","handlers","isInvalidForm","Object","reduce","acc","resetHandler","obj","callback","entries","module","exports","__WEBPACK_EXTERNAL_MODULE__297__","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","call"],"mappings":"klBAAA,aACA,SA4BMA,EAAY,SAA6BC,GAC7C,SAAAC,sBAAsBD,GAAa,SAACE,GAClC,IAAMC,EAAQD,EAAOE,YAAcF,EAAOE,WAAWF,EAAOG,OAC5D,cACKH,GAAM,CACTI,SAAS,EACTC,QAASC,QAAQL,GACjBA,MAAK,QAIE,EAAAM,QAAU,SAA6BT,GAC5C,MAAkB,EAAAU,UAAS,WAAM,OAAAX,EAAA,MAAhCY,EAAI,KAAEC,EAAO,KAEdC,EAAS,EAAAC,SACb,WAAM,SAAAb,sBAAsBU,GAAM,SAAC,GAAc,OAAP,aAC1C,CAACA,IAGGI,EAAW,EAAAC,aACf,SAACC,EAAkCZ,EAAYC,GAC1B,WAAf,EAAOW,GACTL,GAAQ,SAACM,GACP,SAAAjB,sBAAsBiB,GAAM,SAAChB,EAAQiB,GACnC,KAAMA,KAASF,GACb,OAAOf,EAGT,IAAIkB,EACAC,EAEA,EAAAC,YAAaL,EAAYE,IAC3BC,EAAUH,EAAYE,IAEtBC,EAAUH,EAAYE,GAAOd,MAC7BgB,EAAYJ,EAAYE,GAAOb,SAGjC,IAAMH,EAAQD,EAAOE,YAAcF,EAAOE,WAAWgB,GAErD,cACKlB,GAAM,CACTC,MAAK,EACLI,QAASC,QAAQL,GACjBG,QAASe,UAAYnB,EAAOI,QAC5BD,MAAOe,UAAUlB,EAAOG,cAK9BO,GAAQ,SAACM,G,MACDhB,EAASgB,EAAKD,GACdd,EAAQD,EAAOE,YAAcF,EAAOE,WAAWC,GACrD,cACKa,KAAI,MACND,GAAG,OACCf,GAAM,CACTC,MAAOA,EACPI,QAASC,QAAQL,GACjBG,QAASA,UAAWJ,EAAOI,QAC3BD,MAAK,aAMf,IAGIkB,EAAW,EAAAP,aACf,SAACC,GAAa,gBACZO,GAEAT,EAASE,EAAKO,EAAGC,OAASD,EAAGC,OAAOpB,MAAQmB,GAAI,MAElD,CAACT,IAGGW,EAAW,EAAAZ,SACf,WACE,SAAAb,sBAAsBU,GAAM,SAACT,EAAQe,GAAQ,cACxCf,GAAM,CACTqB,SAAUA,EAFiC,UAI/C,CAACA,EAAUZ,IAGPgB,EAAgB,EAAAb,SACpB,WACE,OAAAc,OAAOf,OAAOF,GAAMkB,QAAO,SAACC,EAAK,G,IAAEvB,EAAO,UAAO,OAAAuB,GAAOvB,KAAS,KACnE,CAACI,IASH,MAAO,CACLE,OAAM,EACNa,SAAQ,EACRK,aATmB,EAAAf,aACnB,WAAM,OAAAJ,GAAQ,WAAM,OAAAb,EAAA,QAEpB,IAOAgB,SAAQ,EACRY,cAAa,K,wVChIJ,EAAAL,YAAc,SAAIjB,GAAa,OAAAA,IAAUuB,OAAVvB,IAe/B,EAAAJ,sBAAmD,SAC9D+B,EACAC,GAEA,OAAAL,OAAOM,QAAQF,GAAKH,QAClB,SAACC,EAAK,G,MAACb,EAAG,KAAEf,EAAM,KAAM,cACnB4B,KAAG,MACLb,GAAMgB,EAAS/B,EAAQe,EAAYe,GAAI,MAE1C,M,QC7BJG,EAAOC,QAAUC,ICCbC,EAA2B,GCE/B,ODCA,SAASC,EAAoBC,GAE5B,GAAGF,EAAyBE,GAC3B,OAAOF,EAAyBE,GAAUJ,QAG3C,IAAID,EAASG,EAAyBE,GAAY,CAGjDJ,QAAS,IAOV,OAHAK,EAAoBD,GAAUE,KAAKP,EAAOC,QAASD,EAAQA,EAAOC,QAASG,GAGpEJ,EAAOC,QCjBRG,CAAoB,M","file":"index.min.js","sourcesContent":["import { useCallback, useMemo, useState } from \"react\";\r\nimport { isPrimitive, reduceConfigTransform } from \"./utils\";\r\n\r\nexport type InitialForm<T extends keyof any> = {\r\n  [key in T]: {\r\n    value: any;\r\n    validation?: (\r\n      value: any\r\n    ) =>\r\n      | undefined\r\n      | {\r\n          errorMessage: string;\r\n        };\r\n  };\r\n};\r\n\r\ntype KeyList<T extends InitialForm<any>> = T extends InitialForm<infer R>\r\n  ? R\r\n  : never;\r\n\r\ntype SetValueKey<T extends InitialForm<any>> = {\r\n  [key in KeyList<T>]?:\r\n    | (string | boolean | number)\r\n    | {\r\n        value: any;\r\n        touched: boolean;\r\n      };\r\n};\r\n\r\nconst initialFn = <T extends InitialForm<any>>(initialForm: T) =>\r\n  reduceConfigTransform(initialForm, (config) => {\r\n    const error = config.validation && config.validation(config.value);\r\n    return {\r\n      ...config,\r\n      touched: false,\r\n      invalid: Boolean(error),\r\n      error,\r\n    };\r\n  });\r\n\r\nexport const useForm = <T extends InitialForm<any>>(initialForm: T) => {\r\n  const [form, setForm] = useState(() => initialFn(initialForm));\r\n\r\n  const values = useMemo(\r\n    () => reduceConfigTransform(form, ({ value }) => value),\r\n    [form]\r\n  );\r\n\r\n  const setValue = useCallback(\r\n    (key: KeyList<T> | SetValueKey<T>, value: any, touched: boolean) => {\r\n      if (typeof key === \"object\") {\r\n        setForm((prev) =>\r\n          reduceConfigTransform(prev, (config, field) => {\r\n            if (!(field in key)) {\r\n              return config;\r\n            }\r\n\r\n            let _value;\r\n            let _touched;\r\n\r\n            if (isPrimitive((key as any)[field])) {\r\n              _value = (key as any)[field];\r\n            } else {\r\n              _value = (key as any)[field].value;\r\n              _touched = (key as any)[field].touched;\r\n            }\r\n\r\n            const error = config.validation && config.validation(_value);\r\n\r\n            return {\r\n              ...config,\r\n              error,\r\n              invalid: Boolean(error),\r\n              touched: _touched ?? config.touched,\r\n              value: _value ?? config.value,\r\n            };\r\n          })\r\n        );\r\n      } else {\r\n        setForm((prev) => {\r\n          const config = prev[key];\r\n          const error = config.validation && config.validation(value);\r\n          return {\r\n            ...prev,\r\n            [key]: {\r\n              ...config,\r\n              error: error,\r\n              invalid: Boolean(error),\r\n              touched: touched ?? config.touched,\r\n              value,\r\n            },\r\n          };\r\n        });\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const onChange = useCallback(\r\n    (key: any) => <T extends HTMLTextAreaElement | HTMLInputElement>(\r\n      ev: React.ChangeEvent<T> | any\r\n    ) => {\r\n      setValue(key, ev.target ? ev.target.value : ev, true);\r\n    },\r\n    [setValue]\r\n  );\r\n\r\n  const handlers = useMemo(\r\n    () =>\r\n      reduceConfigTransform(form, (config, key) => ({\r\n        ...config,\r\n        onChange: onChange(key),\r\n      })),\r\n    [onChange, form]\r\n  );\r\n\r\n  const isInvalidForm = useMemo(\r\n    () =>\r\n      Object.values(form).reduce((acc, { invalid }) => acc || invalid, false),\r\n    [form]\r\n  );\r\n\r\n  const resetHandler = useCallback(\r\n    () => setForm(() => initialFn(initialForm)),\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    []\r\n  );\r\n\r\n  return {\r\n    values,\r\n    handlers,\r\n    resetHandler,\r\n    setValue,\r\n    isInvalidForm,\r\n  };\r\n};\r\n","type Merge<A extends Record<string, any>, B extends Record<string, any>> = {\r\n  [K in keyof A]: K extends keyof B ? B[K] : A[K];\r\n} &\r\n  B;\r\n\r\nexport const isPrimitive = <T>(value: T) => value !== Object(value);\r\n\r\ntype ReduceConfigTransformType = <\r\n  TObject extends Record<string, any>,\r\n  Key extends keyof TObject,\r\n  Result\r\n>(\r\n  obj: TObject,\r\n  callback: (config: TObject[Key], key: Key, obj?: TObject) => Result\r\n) => {\r\n  [k in Key]: Result extends Record<string, any>\r\n    ? Merge<Partial<TObject[k]>, Result>\r\n    : Result;\r\n};\r\n\r\nexport const reduceConfigTransform: ReduceConfigTransformType = (\r\n  obj,\r\n  callback\r\n) =>\r\n  Object.entries(obj).reduce(\r\n    (acc, [key, config]) => ({\r\n      ...acc,\r\n      [key]: callback(config, key as any, obj),\r\n    }),\r\n    {} as any\r\n  );\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__297__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(447);\n"],"sourceRoot":""}