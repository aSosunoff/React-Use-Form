{"version":3,"file":"index.js","mappings":"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","sources":["webpack:///./use-did-update.ts","webpack:///./use-form.ts","webpack:///./utils.ts","webpack:///external \"react\"","webpack:///webpack/bootstrap","webpack:///./index.ts"],"sourcesContent":["import { DependencyList, EffectCallback, useEffect, useRef } from \"react\";\n\nexport const useDidUpdate = (\n  effect: EffectCallback,\n  dependencies: DependencyList\n) => {\n  const hasMounted = useRef(true);\n\n  useEffect(() => {\n    if (hasMounted.current) {\n      hasMounted.current = false;\n      return;\n    }\n\n    return effect();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n};\n","import { useCallback, useMemo, useState } from \"react\";\nimport { InitialForm } from \"./types\";\nimport { useDidUpdate } from \"./use-did-update\";\nimport { initialFn, reduceConfigTransform } from \"./utils\";\n\ntype Values<T extends InitialForm<any>> = { [k in keyof T]: any } &\n  Record<string, any>;\n\ntype HandlersConfig = {\n  value: any;\n  error:\n    | {\n        errorMessage: string;\n      }\n    | undefined;\n  touched: boolean;\n  onChange: (value: any) => void;\n};\n\ntype Handlers<T extends InitialForm<any>> = {\n  [k in keyof T]: HandlersConfig;\n} &\n  Record<string, HandlersConfig>;\n\nexport const useForm = <T extends InitialForm<any>>(initialForm: T) => {\n  const [form, setForm] = useState(() => initialFn<keyof T>(initialForm));\n\n  useDidUpdate(() => {\n    setForm(() => initialFn<keyof T>(initialForm));\n  }, [initialForm]);\n\n  const values = useMemo<Values<T>>(\n    () => reduceConfigTransform(form, ({ value }) => value),\n    [form]\n  );\n\n  const addFields = useCallback(\n    (obj: {\n      [field: string]: {\n        value: any;\n        touched?: boolean;\n        validation?: (value: any) =>\n          | undefined\n          | {\n              errorMessage: string;\n            };\n      };\n    }) => {\n      setForm((prev) => ({\n        ...prev,\n        ...reduceConfigTransform(obj, (config) => ({\n          ...config,\n          error: config?.validation && config.validation(config.value),\n          touched: config?.touched ?? false,\n          value: config.value,\n        })),\n      }));\n    },\n    []\n  );\n\n  const removeField = useCallback((fieldName: string) => {\n    setForm((prev) => ({\n      ...(Object.fromEntries(\n        Object.entries(prev).filter(([field]) => field !== fieldName)\n      ) as typeof prev),\n    }));\n  }, []);\n\n  const setValue = useCallback(\n    (key: keyof T, value: any, touched?: boolean) => {\n      setForm((prev) => {\n        const config = prev[key];\n\n        if (!config) return prev;\n\n        return {\n          ...prev,\n          [key]: {\n            ...config,\n            error: config.validation && config.validation(value),\n            touched: touched ?? config.touched,\n            value,\n          },\n        };\n      });\n    },\n    []\n  );\n\n  const setValues = useCallback(\n    (\n      obj: {\n        [key in keyof T]?: {\n          value: any;\n          touched?: boolean;\n        };\n      }\n    ) => {\n      setForm((prev) =>\n        reduceConfigTransform(prev, (config, field) => {\n          if (!(field in obj)) return config;\n\n          const _value = obj[field]?.value;\n\n          return {\n            ...config,\n            error: config.validation && config.validation(_value),\n            touched: obj[field]?.touched ?? config.touched,\n            value: _value ?? config.value,\n          };\n        })\n      );\n    },\n    []\n  );\n\n  const handlers = useMemo<Handlers<T>>(\n    () =>\n      reduceConfigTransform(form, (config, key) => ({\n        value: config.value,\n        error: config.error,\n        touched: config.touched,\n        onChange: (value: any) => setValue(key, value, true),\n      })),\n    [setValue, form]\n  );\n\n  const isInvalidForm = useMemo(\n    () =>\n      Object.values(form).reduce(\n        (acc, { error }) => acc || Boolean(error),\n        false\n      ),\n    [form]\n  );\n\n  const resetHandler = useCallback(\n    () => setForm(() => initialFn<keyof T>(initialForm)),\n    [initialForm]\n  );\n\n  return {\n    values,\n    handlers,\n    resetHandler,\n    setValues,\n    setValue,\n    addFields,\n    removeField,\n    isInvalidForm,\n  };\n};\n","import { InitialForm, ReduceConfigTransformType } from \"./types\";\n\nexport const isPrimitive = (value: unknown): value is true =>\n  value !== Object(value);\n\nexport type CompressType<T extends Record<any, any>, F extends keyof T[any]> = {\n  [key in keyof T]: T[key][F];\n};\n\nexport const reduceConfigTransform: ReduceConfigTransformType = (\n  obj,\n  callback\n) =>\n  Object.entries(obj).reduce(\n    (acc, [key, config]) => ({\n      ...acc,\n      [key]: callback(config, key as any, obj),\n    }),\n    {} as any\n  );\n\nexport const initialFn = <T extends keyof any>(initialForm: InitialForm<T>) =>\n  reduceConfigTransform(initialForm, (config) => ({\n    ...config,\n    touched: false,\n    error: config.validation && config.validation(config.value),\n  }));\n","module.exports = __WEBPACK_EXTERNAL_MODULE__297__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","export { useForm } from \"./use-form\";\nimport { InitialForm } from \"./types\";\nexport type InitialFormType<T extends keyof any> = InitialForm<T>;\n"],"names":[],"sourceRoot":""}